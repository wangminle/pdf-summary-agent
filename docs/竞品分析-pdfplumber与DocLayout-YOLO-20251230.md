# ç«å“åˆ†æï¼špdfplumber ä¸ DocLayout-YOLO

> **åˆ†ææ—¥æœŸ**: 2025-12-30  
> **åˆ†æç›®çš„**: è¯„ä¼°ä¸¤ä¸ª PDF å¤„ç†å·¥å…·çš„æŠ€æœ¯å®ç°å’Œä¸šåŠ¡é€»è¾‘ï¼Œæ¢ç´¢å¯¹å½“å‰é¡¹ç›®ï¼ˆ`pdf-summary-agent`ï¼‰çš„å¯å‘ä»·å€¼

---

## ä¸€ã€ç«å“æ¦‚è§ˆ

| ç»´åº¦ | pdfplumber | DocLayout-YOLO |
|------|-----------|----------------|
| **é¡¹ç›®åœ°å€** | [github.com/jsvine/pdfplumber](https://github.com/jsvine/pdfplumber) | [arxiv.org/abs/2410.12628](https://arxiv.org/abs/2410.12628) |
| **Star æ•°** | 9.4K | - (å­¦æœ¯è®ºæ–‡) |
| **æ ¸å¿ƒå®šä½** | Python PDF æ–‡æœ¬/è¡¨æ ¼æå–åº“ | æ·±åº¦å­¦ä¹ æ–‡æ¡£å¸ƒå±€åˆ†ææ¨¡å‹ |
| **æŠ€æœ¯æ ˆ** | Python + pdfminer.six | YOLOv10 + PyTorch |
| **è®¸å¯è¯** | MIT | - |

---

## äºŒã€pdfplumber æ·±åº¦åˆ†æ

### 2.1 æŠ€æœ¯æ¶æ„

pdfplumber æ„å»ºäº `pdfminer.six` ä¹‹ä¸Šï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯**å¯¹è±¡çº§ç²¾ç»†è®¿é—®**ï¼š

```
PDF æ–‡ä»¶ â†’ pdfminer.six è§£æ â†’ åº•å±‚å¯¹è±¡æå– â†’ é«˜çº§ API å°è£…
                â†“
         å­—ç¬¦/çº¿æ¡/çŸ©å½¢/æ›²çº¿
                â†“
         æ–‡æœ¬æå– + è¡¨æ ¼è¯†åˆ«
```

**å…³é”®æŠ€æœ¯ç»„ä»¶**ï¼š

1. **åº•å±‚å¯¹è±¡è®¿é—®**
   - `page.chars`: æ¯ä¸ªå­—ç¬¦åŠå…¶ç²¾ç¡®åæ ‡ï¼ˆx0, y0, x1, y1ï¼‰ã€å­—ä½“ã€é¢œè‰²
   - `page.lines`: çº¿æ¡å¯¹è±¡ï¼ˆç”¨äºè¡¨æ ¼è¾¹ç•Œæ£€æµ‹ï¼‰
   - `page.rects`: çŸ©å½¢å¯¹è±¡ï¼ˆè¡¨æ ¼å•å…ƒæ ¼è¯†åˆ«ï¼‰
   - `page.curves`: æ›²çº¿å¯¹è±¡

2. **è¡¨æ ¼æå–ç­–ç•¥**ï¼ˆæ ¸å¿ƒäº®ç‚¹ï¼‰
   
   | ç­–ç•¥ | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
   |-----|------|---------|
   | `lines` | ä½¿ç”¨é¡µé¢ä¸­çš„å›¾å½¢çº¿æ¡ï¼ˆå«çŸ©å½¢è¾¹ï¼‰ä½œä¸ºè¡¨æ ¼è¾¹ç•Œ | æœ‰æ˜ç¡®è¾¹æ¡†çš„è¡¨æ ¼ |
   | `lines_strict` | ä»…ä½¿ç”¨çº¿æ¡ï¼Œä¸å«çŸ©å½¢è¾¹ | é¿å…çŸ©å½¢å¹²æ‰° |
   | `text` | æ ¹æ®æ–‡å­—å¯¹é½æ¨æ–­è™šæ‹Ÿè¾¹ç•Œ | æ— è¾¹æ¡†è¡¨æ ¼ |
   | `explicit` | ç”¨æˆ·æ˜¾å¼æŒ‡å®šè¾¹ç•Œçº¿ | ç‰¹æ®Šå¸ƒå±€ |

3. **å¯é…ç½®å‚æ•°çŸ©é˜µ**
   ```python
   table_settings = {
       "vertical_strategy": "lines",     # å‚ç›´è¾¹ç•Œç­–ç•¥
       "horizontal_strategy": "text",    # æ°´å¹³è¾¹ç•Œç­–ç•¥
       "snap_tolerance": 3,              # çº¿æ¡å¸é™„å®¹å·®
       "snap_x_tolerance": 3,
       "snap_y_tolerance": 3,
       "join_tolerance": 3,              # çº¿æ¡è¿æ¥å®¹å·®
       "edge_min_length": 3,             # æœ€å°è¾¹é•¿
       "min_words_vertical": 3,          # å‚ç›´æœ€å°‘å•è¯æ•°
       "min_words_horizontal": 1,        # æ°´å¹³æœ€å°‘å•è¯æ•°
       "text_x_tolerance": 3,            # æ–‡æœ¬ X å®¹å·®
       "text_y_tolerance": 3,            # æ–‡æœ¬ Y å®¹å·®
   }
   ```

### 2.2 æ ¸å¿ƒåŠŸèƒ½ä¸ API

```python
import pdfplumber

with pdfplumber.open("document.pdf") as pdf:
    page = pdf.pages[0]
    
    # 1. æ–‡æœ¬æå–ï¼ˆä¿ç•™åæ ‡ï¼‰
    text = page.extract_text()
    words = page.extract_words()  # å¸¦ bbox
    
    # 2. è¡¨æ ¼æå–
    tables = page.extract_tables()
    
    # 3. å¯è§†åŒ–è°ƒè¯•ï¼ˆäº®ç‚¹åŠŸèƒ½ï¼‰
    im = page.to_image(resolution=150)
    im.draw_rects(page.extract_words())
    im.debug_tablefinder()  # æ˜¾ç¤ºè¡¨æ ¼æ£€æµ‹è¿‡ç¨‹
    im.save("debug.png")
    
    # 4. é¡µé¢è£å‰ª
    cropped = page.crop((x0, y0, x1, y1))
    cropped_text = cropped.extract_text()
```

### 2.3 ä¼˜åŠ¿ä¸å±€é™

**ä¼˜åŠ¿**ï¼š
- âœ… **ç²¾ç»†çš„å¯¹è±¡çº§è®¿é—®**ï¼šæ¯ä¸ªå­—ç¬¦ã€çº¿æ¡éƒ½æœ‰ç²¾ç¡®åæ ‡
- âœ… **çµæ´»çš„è¡¨æ ¼ç­–ç•¥**ï¼š4 ç§ç­–ç•¥ + ä¸°å¯Œå‚æ•°ï¼Œé€‚é…å¤šç§è¡¨æ ¼å¸ƒå±€
- âœ… **å¯è§†åŒ–è°ƒè¯•**ï¼šå†…ç½® debug åŠŸèƒ½ï¼Œå¿«é€Ÿå®šä½é—®é¢˜
- âœ… **è½»é‡çº§**ï¼šä»…ä¾èµ– pdfminer.sixï¼Œå†…å­˜å ç”¨ä½ 40%
- âœ… **API ç®€æ´**ï¼šé“¾å¼è°ƒç”¨ï¼Œæ˜“äºé›†æˆ

**å±€é™**ï¼š
- âŒ **æ— è¯­ä¹‰ç†è§£**ï¼šä¸è¯†åˆ«"Figure 1"/"Table 2"ç­‰å­¦æœ¯å›¾æ³¨
- âŒ **æ— å›¾åƒæå–**ï¼šä»…å¤„ç†æ–‡æœ¬å±‚ï¼Œä¸æå–åµŒå…¥å›¾åƒ
- âŒ **æ— å¸ƒå±€åˆ†æ**ï¼šä¸åŒºåˆ†æ ‡é¢˜ã€æ®µè½ã€å›¾è¡¨åŒºåŸŸ
- âŒ **å¯¹æ‰«æä»¶æ— æ•ˆ**ï¼šä¾èµ– PDF æ–‡æœ¬å±‚ï¼Œä¸æ”¯æŒ OCR

### 2.4 å¯¹æœ¬é¡¹ç›®çš„å¯å‘

| å¯å‘ç‚¹ | pdfplumber åšæ³• | å¯å€Ÿé‰´æ–¹å‘ |
|-------|----------------|-----------|
| **è¡¨æ ¼è¾¹ç•Œæ£€æµ‹** | åŸºäºçº¿æ¡/æ–‡æœ¬å¯¹é½çš„å¤šç­–ç•¥æ–¹æ¡ˆ | å¢å¼º `extract_tables()` çš„è¡¨æ ¼å†…éƒ¨ç»“æ„è¯†åˆ« |
| **å¯è§†åŒ–è°ƒè¯•** | `page.to_image().debug_tablefinder()` | ç»Ÿä¸€ `--debug-visual` çš„è°ƒè¯•å›¾å±‚å‘½åå’Œè¾“å‡ºæ ¼å¼ |
| **å‚æ•°å¯é…ç½®** | ä¸°å¯Œçš„ tolerance/threshold å‚æ•° | å¯¹é½å½“å‰ `--*-th` ç³»åˆ—å‚æ•°ï¼Œæä¾›æ›´ç»†ç²’åº¦æ§åˆ¶ |
| **é¡µé¢è£å‰ª** | `page.crop((bbox))` è¯­ä¹‰æ¸…æ™° | ç®€åŒ–å½“å‰çª—å£è®¡ç®—é€»è¾‘çš„ API å°è£… |

---

## ä¸‰ã€DocLayout-YOLO æ·±åº¦åˆ†æ

### 3.1 è®ºæ–‡èƒŒæ™¯ä¸åŠ¨æœº

**è®ºæ–‡ä¿¡æ¯**ï¼š
- æ ‡é¢˜ï¼šDocLayout-YOLO: Enhancing Document Layout Analysis through Diverse Synthetic Data and Global-to-Local Adaptive Perception
- arXiv: 2410.12628v1
- æœºæ„ï¼šOpenDataLab (ä¸Šæµ·äººå·¥æ™ºèƒ½å®éªŒå®¤)

**æ ¸å¿ƒé—®é¢˜**ï¼š
ä¼ ç»Ÿæ–‡æ¡£å¸ƒå±€åˆ†æé¢ä¸´ä¸¤å¤§æŒ‘æˆ˜ï¼š
1. **æ•°æ®å¤šæ ·æ€§ä¸è¶³**ï¼šå…¬å¼€æ•°æ®é›†é£æ ¼å•ä¸€ï¼Œæ¨¡å‹æ³›åŒ–èƒ½åŠ›å¼±
2. **å¤šå°ºåº¦æ£€æµ‹å›°éš¾**ï¼šæ–‡æ¡£å…ƒç´ å°ºåº¦å·®å¼‚å¤§ï¼ˆæ ‡é¢˜ vs è„šæ³¨ vs å›¾è¡¨ï¼‰

### 3.2 æ ¸å¿ƒæŠ€æœ¯åˆ›æ–°

#### 3.2.1 Mesh-candidate BestFit ç®—æ³•ï¼ˆæ•°æ®åˆæˆï¼‰

å°†æ–‡æ¡£åˆæˆå»ºæ¨¡ä¸º**äºŒç»´è£…ç®±é—®é¢˜ï¼ˆ2D Bin Packingï¼‰**ï¼š

```
è¾“å…¥ï¼šå¤šæºæ–‡æ¡£å…ƒç´ ï¼ˆæ ‡é¢˜ã€æ®µè½ã€å›¾ç‰‡ã€è¡¨æ ¼ã€å…¬å¼...ï¼‰
      â†“
Step 1: æ„å»ºå€™é€‰ç½‘æ ¼ï¼ˆMesh-candidateï¼‰
      â†“
Step 2: BestFit è´ªå¿ƒå¡«å……ï¼ˆæŒ‰é¢ç§¯é™åºï¼‰
      â†“
Step 3: è¾¹è·/å¯¹é½éšæœºæ‰°åŠ¨
      â†“
è¾“å‡ºï¼šDocSynth-300K åˆæˆæ•°æ®é›†
```

**æ•ˆæœ**ï¼š
- ç”Ÿæˆ 30 ä¸‡å¼ å¤šæ ·åŒ–æ–‡æ¡£å›¾åƒ
- è¦†ç›–å•æ /åŒæ /æ··æ’/å›¾æ–‡æ··åˆç­‰å¤šç§å¸ƒå±€
- æ˜¾è‘—æå‡æ¨¡å‹åœ¨æœªè§é£æ ¼æ–‡æ¡£ä¸Šçš„æ³›åŒ–èƒ½åŠ›

#### 3.2.2 GL-CRMï¼ˆå…¨å±€åˆ°å±€éƒ¨å¯æ§æ„Ÿå—é‡æ¨¡å—ï¼‰

è§£å†³**å¤šå°ºåº¦æ£€æµ‹**é—®é¢˜çš„å…³é”®æ¨¡å—ï¼š

```
è¾“å…¥ç‰¹å¾ F
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å…¨å±€åˆ†æ”¯ï¼ˆGlobalï¼‰                     â”‚
â”‚  - å¤§æ„Ÿå—é‡                            â”‚
â”‚  - æ•è·æ•´ä½“å¸ƒå±€ã€å¤§å°ºåº¦å…ƒç´              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å±€éƒ¨åˆ†æ”¯ï¼ˆLocalï¼‰                      â”‚
â”‚  - å°æ„Ÿå—é‡                            â”‚
â”‚  - ç²¾ç¡®å®šä½å°å°ºåº¦å…ƒç´ ï¼ˆè„šæ³¨ã€ç¼–å·ç­‰ï¼‰    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è‡ªé€‚åº”èåˆï¼ˆAdaptive Fusionï¼‰          â”‚
â”‚  - æ ¹æ®è¾“å…¥åŠ¨æ€è°ƒæ•´å…¨å±€/å±€éƒ¨æƒé‡        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
è¾“å‡ºç‰¹å¾ F'ï¼ˆå¤šå°ºåº¦å¢å¼ºï¼‰
```

**æŠ€æœ¯ç»†èŠ‚**ï¼š
- åŸºäº YOLOv10 ä¸»å¹²ç½‘ç»œ
- å¯å¾®åˆ†æ„Ÿå—é‡è°ƒåˆ¶
- ç«¯åˆ°ç«¯è®­ç»ƒ

### 3.3 æ€§èƒ½è¡¨ç°

| æ•°æ®é›† | mAP | FPS |
|-------|-----|-----|
| DocLayNet | 69.8 | 85.5 |
| D4LA | 65.2 | 85.5 |
| PubLayNet | 93.4 | 85.5 |

**å…³é”®æŒ‡æ ‡**ï¼š
- **å®æ—¶æ€§**ï¼š85.5 FPSï¼ˆåœ¨ RTX 3090 ä¸Šï¼‰
- **ç²¾åº¦**ï¼šå¤šä¸ªæ•°æ®é›† SOTA
- **æ³›åŒ–æ€§**ï¼šè·¨åŸŸæµ‹è¯•è¡¨ç°ä¼˜å¼‚

### 3.4 æ£€æµ‹ç±»åˆ«

DocLayout-YOLO å¯æ£€æµ‹çš„æ–‡æ¡£å…ƒç´ ï¼š

| ç±»åˆ« | è¯´æ˜ |
|-----|------|
| `title` | æ ‡é¢˜ï¼ˆH1-H6ï¼‰ |
| `plain_text` | æ­£æ–‡æ®µè½ |
| `abandon` | é¡µçœ‰é¡µè„šç­‰æ— å…³å†…å®¹ |
| `figure` | å›¾ç‰‡ |
| `figure_caption` | å›¾ç‰‡æ ‡é¢˜ |
| `table` | è¡¨æ ¼ |
| `table_caption` | è¡¨æ ¼æ ‡é¢˜ |
| `table_footnote` | è¡¨æ ¼è„šæ³¨ |
| `isolate_formula` | ç‹¬ç«‹å…¬å¼ |
| `formula_caption` | å…¬å¼ç¼–å· |

### 3.5 å¯¹æœ¬é¡¹ç›®çš„å¯å‘

| å¯å‘ç‚¹ | DocLayout-YOLO åšæ³• | å¯å€Ÿé‰´æ–¹å‘ |
|-------|-------------------|-----------|
| **Figure-Caption é…å¯¹** | æ£€æµ‹è¾“å‡ºåŒ…å« `figure` + `figure_caption` | æ”¹è¿›å½“å‰ caption é©±åŠ¨ç­–ç•¥ï¼Œå¢åŠ  bbox çº§é…å¯¹éªŒè¯ |
| **Table-Caption åˆ†ç¦»** | æ˜ç¡®åŒºåˆ† `table` / `table_caption` / `table_footnote` | å¢å¼ºè¡¨æ ¼åŒºåŸŸè¯†åˆ«ï¼Œé¿å…è¯¯åŒ…å«è„šæ³¨ |
| **é¡µçœ‰é¡µè„šè¯†åˆ«** | `abandon` ç±»åˆ«è‡ªåŠ¨è¿‡æ»¤ | å¢å¼º P1-02 Gathering é˜¶æ®µçš„ header/footer æ£€æµ‹ |
| **å¤šå°ºåº¦é€‚åº”** | GL-CRM åŠ¨æ€æ„Ÿå—é‡ | å½“å‰ `--scan-heights` å¤šé«˜åº¦æ»‘çª—ç­–ç•¥çš„ç†è®ºæ”¯æ’‘ |
| **æ•°æ®å¢å¼ºæ€è·¯** | Mesh-candidate BestFit åˆæˆ | å¯è€ƒè™‘æ„å»ºæµ‹è¯•åŸºå‡†é›†çš„å¤šæ ·åŒ–æ ·æœ¬ |

---

## å››ã€ä¸å½“å‰é¡¹ç›®çš„æ¨ªå‘å¯¹æ¯”

### 4.1 æŠ€æœ¯è·¯çº¿å¯¹æ¯”

| ç»´åº¦ | pdfplumber | DocLayout-YOLO | æœ¬é¡¹ç›® (extract_pdf_assets.py) |
|-----|-----------|----------------|------------------------------|
| **æ ¸å¿ƒä¾èµ–** | pdfminer.six | PyTorch + YOLO | PyMuPDF + pdfminer.six |
| **æŠ€æœ¯è·¯çº¿** | è§„åˆ™é©±åŠ¨ | æ·±åº¦å­¦ä¹  | è§„åˆ™ + å¯å‘å¼è¯„åˆ† |
| **å›¾åƒæå–** | âŒ ä¸æ”¯æŒ | âœ… æ£€æµ‹ bbox | âœ… åŸºäº caption è£å‰ª |
| **è¡¨æ ¼è¯†åˆ«** | âœ… å¤šç­–ç•¥ | âœ… æ£€æµ‹ bbox | âœ… ç‰¹åŒ–è¯„åˆ† + ç²¾è£ |
| **è¯­ä¹‰ç†è§£** | âŒ æ—  | âœ… ç±»åˆ«åˆ†ç±» | âœ… æ™ºèƒ½ caption è¯†åˆ« |
| **æ–‡æœ¬æå–** | âœ… ç²¾ç»† | âŒ ä¸æ”¯æŒ | âœ… PyMuPDF/pdfminer |
| **å®æ—¶æ€§** | âœ… å¿« | âœ… 85.5 FPS | âš ï¸ è¾ƒæ…¢ï¼ˆå¤šé˜¶æ®µç²¾è£ï¼‰ |
| **å­¦æœ¯è®ºæ–‡é€‚é…** | âš ï¸ ä¸€èˆ¬ | âš ï¸ ä¸€èˆ¬ | âœ… é«˜åº¦ç‰¹åŒ– |

### 4.2 åŠŸèƒ½è¦†ç›–å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PDF å¤„ç†èƒ½åŠ›å…¨æ™¯                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æ–‡æœ¬æå– â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  pdfplumber (ç²¾ç»†åæ ‡)            â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  æœ¬é¡¹ç›® (PyMuPDF + gathered_text) â”‚
â”‚          â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  DocLayout-YOLO (ä¸æ”¯æŒ)          â”‚
â”‚                                                                 â”‚
â”‚  è¡¨æ ¼æå– â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  pdfplumber (å¤šç­–ç•¥)              â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  æœ¬é¡¹ç›® (caption é©±åŠ¨)            â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  DocLayout-YOLO (ä»…æ£€æµ‹ bbox)     â”‚
â”‚                                                                 â”‚
â”‚  å›¾è¡¨æå– â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  pdfplumber (ä¸æ”¯æŒ)              â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  æœ¬é¡¹ç›® (Anchor v2 + A/B/D ç²¾è£)  â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  DocLayout-YOLO (æ£€æµ‹ bbox)       â”‚
â”‚                                                                 â”‚
â”‚  å¸ƒå±€åˆ†æ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  pdfplumber (ä»…å¯¹è±¡åæ ‡)          â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  æœ¬é¡¹ç›® (V2 ç‰ˆå¼é©±åŠ¨)             â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  DocLayout-YOLO (ä¸“ä¸šå¸ƒå±€æ¨¡å‹)    â”‚
â”‚                                                                 â”‚
â”‚  Caption  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  pdfplumber (æ— )                 â”‚
â”‚  è¯†åˆ«     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  æœ¬é¡¹ç›® (æ™ºèƒ½å››ç»´è¯„åˆ†)            â”‚
â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  DocLayout-YOLO (ç±»åˆ«æ£€æµ‹)        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 é€‚ç”¨åœºæ™¯çŸ©é˜µ

| åœºæ™¯ | pdfplumber | DocLayout-YOLO | æœ¬é¡¹ç›® |
|-----|-----------|----------------|-------|
| å­¦æœ¯è®ºæ–‡å›¾è¡¨æå– | â­â­ | â­â­â­ | â­â­â­â­â­ |
| è´¢åŠ¡æŠ¥è¡¨è¡¨æ ¼æå– | â­â­â­â­â­ | â­â­â­ | â­â­â­ |
| é€šç”¨æ–‡æ¡£å¸ƒå±€åˆ†æ | â­â­ | â­â­â­â­â­ | â­â­â­ |
| æ‰¹é‡ PDF å¤„ç† | â­â­â­â­ | â­â­â­â­â­ | â­â­â­ |
| å¸¦å›¾æ‘˜è¦ç”Ÿæˆæµæ°´çº¿ | â­ | â­â­ | â­â­â­â­â­ |

---

## äº”ã€å¯å€Ÿé‰´çš„æ”¹è¿›æ–¹å‘

### 5.1 çŸ­æœŸæ”¹è¿›ï¼ˆP1 çº§åˆ«ï¼‰

#### 5.1.1 å€Ÿé‰´ pdfplumber çš„å¯è§†åŒ–è°ƒè¯•æœºåˆ¶

**ç°çŠ¶**ï¼šå½“å‰ `--debug-visual` è¾“å‡ºå¤šè‰²è¾¹ç•Œæ¡†ï¼Œä½†ç¼ºä¹äº¤äº’å¼è°ƒè¯•èƒ½åŠ›ã€‚

**æ”¹è¿›æ–¹æ¡ˆ**ï¼š
```python
# æ–°å¢ DebugVisualizer ç±»ï¼Œå‚è€ƒ pdfplumber çš„é“¾å¼è°ƒç”¨
class DebugVisualizer:
    def draw_caption_candidates(self, color="purple"):
        """ç»˜åˆ¶æ‰€æœ‰ caption å€™é€‰"""
    
    def draw_anchor_windows(self, above_color="blue", below_color="green"):
        """ç»˜åˆ¶é”šç‚¹çª—å£"""
    
    def draw_refinement_stages(self):
        """ç»˜åˆ¶ A/B/D å„é˜¶æ®µè¾¹ç•Œ"""
    
    def annotate_scores(self):
        """æ ‡æ³¨è¯„åˆ†æ•°å€¼"""
    
    def save(self, path):
        """ä¿å­˜è°ƒè¯•å›¾"""
```

#### 5.1.2 å€Ÿé‰´ DocLayout-YOLO çš„å¤šå°ºåº¦æ„ŸçŸ¥

**ç°çŠ¶**ï¼š`--scan-heights` æ”¯æŒå¤šé«˜åº¦æ»‘çª—ï¼Œä½†ç¼ºä¹è‡ªé€‚åº”æƒé‡ã€‚

**æ”¹è¿›æ–¹æ¡ˆ**ï¼š
- ä¸ºä¸åŒæ‰«æé«˜åº¦å¼•å…¥**ç½®ä¿¡åº¦æƒé‡**
- å¤§é«˜åº¦çª—å£ç”¨äºæ£€æµ‹å®Œæ•´å›¾è¡¨ï¼Œå°é«˜åº¦ç”¨äºç²¾ç¡®è¾¹ç•Œ
- ç±»ä¼¼ GL-CRM çš„èåˆç­–ç•¥ï¼š
  ```python
  def fuse_candidates(candidates_list, height_weights):
      """èåˆä¸åŒé«˜åº¦çš„å€™é€‰çª—å£"""
      for height, candidates in candidates_list:
          weight = height_weights.get(height, 1.0)
          for c in candidates:
              c.score *= weight
      # éæå¤§å€¼æŠ‘åˆ¶
      return nms(all_candidates)
  ```

### 5.2 ä¸­æœŸæ”¹è¿›ï¼ˆP2 çº§åˆ«ï¼‰

#### 5.2.1 é›†æˆè½»é‡çº§å¸ƒå±€æ£€æµ‹æ¨¡å‹

**ç›®æ ‡**ï¼šå°† DocLayout-YOLO ä½œä¸ºå¯é€‰é¢„å¤„ç†æ­¥éª¤ï¼Œæä¾› bbox çº§çš„ figure/table å®šä½ã€‚

**æ¶æ„è®¾è®¡**ï¼š
```
PDF è¾“å…¥
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é¢„å¤„ç†åˆ†æ”¯ï¼ˆå¯é€‰ï¼‰                     â”‚
â”‚  â”œâ”€ DocLayout-YOLO æ¨ç†                â”‚
â”‚  â””â”€ è¾“å‡º: figure_bboxes, table_bboxes â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Caption é©±åŠ¨åˆ†æ”¯ï¼ˆç°æœ‰ä¸»æµç¨‹ï¼‰          â”‚
â”‚  â”œâ”€ æ™ºèƒ½ caption è¯†åˆ«                  â”‚
â”‚  â”œâ”€ Anchor v2 æ»‘çª—è¯„åˆ†                 â”‚
â”‚  â””â”€ A/B/D ç²¾è£                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  èåˆå†³ç­–                              â”‚
â”‚  â”œâ”€ è‹¥ YOLO bbox ä¸ caption åŒ¹é…åº¦é«˜   â”‚
â”‚  â”‚   â†’ ä½¿ç”¨ YOLO bbox ä½œä¸ºåˆå§‹çª—å£     â”‚
â”‚  â””â”€ å¦åˆ™ â†’ æ²¿ç”¨ caption é©±åŠ¨ç»“æœ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°è¦ç‚¹**ï¼š
- DocLayout-YOLO ä½œä¸º**å¯é€‰ä¾èµ–**ï¼ˆ`pip install doclayout-yolo`ï¼‰
- é»˜è®¤å…³é—­ï¼ˆ`--use-layout-model off`ï¼‰
- æä¾› bbox åŒ¹é…é˜ˆå€¼é…ç½®

#### 5.2.2 å¢å¼ºè¡¨æ ¼å†…éƒ¨ç»“æ„è¯†åˆ«

**å€Ÿé‰´ pdfplumber çš„è¡¨æ ¼ç­–ç•¥**ï¼š
```python
def extract_table_structure(page, table_bbox, strategy="auto"):
    """
    æå–è¡¨æ ¼å†…éƒ¨ç»“æ„
    
    ç­–ç•¥:
    - lines: åŸºäºçº¿æ¡æ£€æµ‹å•å…ƒæ ¼
    - text:  åŸºäºæ–‡æœ¬å¯¹é½æ¨æ–­
    - hybrid: ç»“åˆçº¿æ¡å’Œæ–‡æœ¬
    - auto:  è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜ç­–ç•¥
    """
    if strategy == "auto":
        # æ£€æµ‹æ˜¯å¦æœ‰è¶³å¤Ÿçº¿æ¡
        lines_in_bbox = filter_by_bbox(page.lines, table_bbox)
        if len(lines_in_bbox) > 5:
            strategy = "lines"
        else:
            strategy = "text"
    
    # æ‰§è¡Œå¯¹åº”ç­–ç•¥
    ...
```

### 5.3 é•¿æœŸæ¼”è¿›ï¼ˆP3 çº§åˆ«ï¼‰

#### 5.3.1 æ„å»ºç»Ÿä¸€çš„å¸ƒå±€-å†…å®¹å…³è”æ¨¡å‹

å€Ÿé‰´ Uni-Parser çš„ **Group-based Layout Detection** æ€æƒ³ï¼š

```
ä¼ ç»Ÿæµç¨‹:  Layout Detection â†’ Content Extraction â†’ Post-Association
                â†“                    â†“                    â†“
           ç‹¬ç«‹è¾“å‡º              ç‹¬ç«‹è¾“å‡º              å¯å‘å¼åŒ¹é…

æ–°æµç¨‹:    Group-based Detection â†’ Paired Output
                    â†“
           (figure, figure_caption) æˆå¯¹è¾“å‡º
           (table,  table_caption)  æˆå¯¹è¾“å‡º
```

**index.json æ‰©å±•**ï¼š
```json
{
  "groups": [
    {
      "group_id": 1,
      "type": "figure_group",
      "members": {
        "figure": {"bbox": [...], "page": 3},
        "caption": {"text": "Figure 1. ...", "bbox": [...]}
      },
      "confidence": 0.95
    }
  ]
}
```

#### 5.3.2 æ”¯æŒç«¯åˆ°ç«¯çš„å¤šæ¨¡æ€è§£æ

å‚è€ƒ DocLayout-YOLO æ”¯æŒçš„å®Œæ•´ç±»åˆ«åˆ—è¡¨ï¼Œæ‰©å±•è§£æèƒ½åŠ›ï¼š

| å½“å‰æ”¯æŒ | å¾…æ‰©å±• |
|---------|-------|
| Figure | Isolate Formula |
| Table | Formula Caption |
| Figure Caption | Table Footnote |
| Table Caption | Algorithm/Code Block |

---

## å…­ã€å®æ–½å»ºè®®ä¸ä¼˜å…ˆçº§

### 6.1 ä¼˜å…ˆçº§æ’åº

| ä¼˜å…ˆçº§ | æ”¹è¿›é¡¹ | é¢„æœŸæ”¶ç›Š | å®æ–½æˆæœ¬ |
|-------|-------|---------|---------|
| **P1** | å¯è§†åŒ–è°ƒè¯•æœºåˆ¶å¢å¼º | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | ä½ |
| **P1** | å¤šå°ºåº¦å€™é€‰èåˆä¼˜åŒ– | ğŸŒŸğŸŒŸğŸŒŸ | ä¸­ |
| **P2** | pdfplumber è¡¨æ ¼ç­–ç•¥é›†æˆ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | ä¸­ |
| **P2** | DocLayout-YOLO å¯é€‰é›†æˆ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | é«˜ |
| **P3** | ç»Ÿä¸€å¸ƒå±€-å†…å®¹å…³è”æ¨¡å‹ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | å¾ˆé«˜ |

### 6.2 æŠ€æœ¯å€ºåŠ¡è­¦ç¤º

1. **é¿å…è¿‡åº¦ä¾èµ–æ·±åº¦å­¦ä¹ **
   - DocLayout-YOLO éœ€è¦ GPU æ¨ç†
   - å¢åŠ éƒ¨ç½²å¤æ‚åº¦
   - å»ºè®®ä½œä¸º**å¯é€‰å¢å¼º**è€Œéå¿…é€‰ä¾èµ–

2. **ä¿æŒ caption é©±åŠ¨çš„æ ¸å¿ƒä¼˜åŠ¿**
   - å½“å‰æ–¹æ¡ˆåœ¨å­¦æœ¯è®ºæ–‡åœºæ™¯ä¸‹å‡†ç¡®ç‡å·²å¾ˆé«˜
   - æ–°å¢åŠŸèƒ½åº”**å¢å¼º**è€Œé**æ›¿ä»£**ç°æœ‰æµç¨‹

3. **æµ‹è¯•è¦†ç›–å…ˆè¡Œ**
   - ä»»ä½•æ–°å¢åŠŸèƒ½éœ€é…å¥— golden test
   - å‚è€ƒ `scripts/tests/test_*.py` çš„æµ‹è¯•æ¡†æ¶

---

## ä¸ƒã€æ€»ç»“

### 7.1 æ ¸å¿ƒç»“è®º

| å·¥å…· | æ ¸å¿ƒä»·å€¼ | ä¸æœ¬é¡¹ç›®çš„å…³ç³» |
|-----|---------|--------------|
| **pdfplumber** | è¡¨æ ¼æå–å¤šç­–ç•¥ + å¯è§†åŒ–è°ƒè¯• | **äº’è¡¥**ï¼šå¯å€Ÿé‰´è¡¨æ ¼ç­–ç•¥å’Œè°ƒè¯•æœºåˆ¶ |
| **DocLayout-YOLO** | æ·±åº¦å­¦ä¹ å¸ƒå±€åˆ†æ + å¤šå°ºåº¦æ„ŸçŸ¥ | **å¢å¼º**ï¼šå¯ä½œä¸ºå¯é€‰é¢„å¤„ç†æä¾› bbox éªŒè¯ |

### 7.2 æ¨èè¡ŒåŠ¨

1. **çŸ­æœŸï¼ˆ1-2å‘¨ï¼‰**ï¼š
   - å‚è€ƒ pdfplumber ä¼˜åŒ– `--debug-visual` è¾“å‡ºæ ¼å¼
   - å¢åŠ è¡¨æ ¼å†…éƒ¨çº¿æ¡æ£€æµ‹é€»è¾‘

2. **ä¸­æœŸï¼ˆ1-2æœˆï¼‰**ï¼š
   - ç ”ç©¶ DocLayout-YOLO çš„é›†æˆå¯è¡Œæ€§
   - æ„å»º bbox åŒ¹é…éªŒè¯æœºåˆ¶

3. **é•¿æœŸï¼ˆæŒç»­è¿­ä»£ï¼‰**ï¼š
   - è·Ÿè¸ª pdfplumber/DocLayout-YOLO æ›´æ–°
   - è¯„ä¼° Uni-Parser é£æ ¼çš„æ¶æ„å‡çº§

---

## é™„å½•ï¼šå‚è€ƒèµ„æ–™

1. [pdfplumber GitHub](https://github.com/jsvine/pdfplumber) - MIT License
2. [DocLayout-YOLO Paper](https://arxiv.org/abs/2410.12628) - arXiv:2410.12628
3. [pdfminer.six Documentation](https://pdfminersix.readthedocs.io/)
4. [YOLOv10 Architecture](https://arxiv.org/abs/2405.14458)
5. æœ¬é¡¹ç›®å·²æœ‰åˆ†ææ–‡æ¡£ï¼š
   - `ref/å‚è€ƒä»£ç åˆ†æ-Gemini-2.5-Pro-20251014.md`
   - `ref/å‚è€ƒä»£ç åˆ†æ-GPT-5-High-20251014.md`
   - `docs/20251221/Uni-Parserå¯å‘_æ”¹é€ æ¸…å•-20251221.md`
